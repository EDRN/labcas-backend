LabCAS INSTALLATION INSTRUCTIONS

o Prerequisites

Java 1.7+
Unix OS (Linux, MacOSX, ...)

Maven 2.2+

o Define environment where software will be installed

For example:

export LABCAS_HOME=/usr/local/labcas
	- location where all software components will be installed

export DATA_ARCHIVE=/usr/local/data
	- location where files will be archived

o Check out code from repository
(to any directory, for example ~/src)

git clone https://github.com/EDRN/labcas-backend.git

o Compile and install

cd labcas-backend
mvn install
	- will install all back-end services
	
mvn install -Dworkflow=labcas-test
	- will install the specific configuration for "labcas-test" workflow on top of the existing services
	
mvn install -Dworkflow=biomarker-discovery
	- will install the specific configuration for "biomarker-discovery" workflow on top of the existing services
	
source $LABCAS_HOME/env.sh
	- defines additional internal environment variables
	
o Directory structure

o Start services

cd $LABCAS_HOME
./start.sh

or to start a single service:
cd $LABCAS_HOME/cas-workflow/bin
./wmgr start

o Test

Query Workflow Manager for available workflows
cd $LABCAS_HOME
./wmgr-client -op -events -url http://localhost:9001

Query Solr
http://<hostname>:8080/solr/


o Run workflow

cd LABCAS_HOME/cas-workflow/bin

./wmgr-client --url http://localhost:9001 --operation --sendEvent --eventName labcas-test --metaData --key experiment 1


./wmgr-client --url http://localhost:9001 --operation --sendEvent --eventName biomarker-discovery-0 --metaData --key ncv 2 --key MyKey MyValue
or:
./wmgr-client --url http://localhost:9001 --operation --sendEvent --eventName biomarker-discovery --metaData --key ncv 2 --key MyKey MyValue

After successful run:

- job output is contained within directory <PGE_ROOT>/labcas-test/jobs/<job_id>
	- labcas-test-output.txt contains run output
	- labcas-test-output.txt.met contains job metadata generated while crawling
	- sciPgeExeScript_LabcasTestTask contains runnable task script
	- logs/

- directory $PGE_ROOT contains output file output.txt
- directory $PGE_ROOT/jobs contains script executable and log files


o Stop services

cd $LABCAS_HOME
./stop.sh


o Upgrade installation

to only upgrade specific components: cd to the module subdirectory and mvn install, for example:
cd solr
mvn install

o Clean up

mvn clean
	- will remove all services from $LABCAS_HOME

mvn clean -Dworkflow=biomarker-discovery
	- will remove the specific workflow configuration
	

